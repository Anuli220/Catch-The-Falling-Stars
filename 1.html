<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
         body {
     background-color: midnightblue;
     color: white;
     font-family: 'Segoe UI', sans-serif;
     justify-content: center;
     padding: 20px;
     display: flex;
     flex-direction: column;
     text-align: center;
 }

 h1 {
     margin-bottom: 10px;
 }

 #game-area {
     width: 50px;
     height: 50px;
     background-color: midnightblue;
     border: none;
     position: relative;
     overflow: hidden;
     margin: 20px 0;
 }

 .basket {
     width: 20px;
     height: 20px;
     color: goldenrod;
     position: absolute;
     bottom: 30px;
     left: 10px;
     border-radius: 10px;
     background-color: goldenrod;
 }

 .star {
     width: 30px;
     height: 30px;
     background-color: gold;
     border-radius: 10rem;
     position: absolute;
     top: 0;
 }

 button {
     padding: 10px 20px;
     cursor: pointer;
     margin: 5px;
     font-size: 40px;
     background-color: crimson;
     color: white;
     border-radius: 10px;
     border: none;
     transition: transform 0.15s ease, background 0.15s ease;
 }


 button:hover:not(:disabled) {
     background-color: rgb(133, 26, 26);
     transform: scale(1.05);
 }

 button:disabled {
     background: grey;
     cursor: not-allowed;
     transform: none;
 }

 #score, #lives {
     font-size: 22px;
     margin: 10px;
 }


 #message {
     font-size: 24px;
     color: gold;
     margin-top: 10px;
 }

 @media (max-width: 400px) {
    .game-area{
        width: 300px;
        height: 450px;
    }

    .basket{
        width: 80px;
        left: 110px;
    }

    .star{
        width: 25px;
        height: 25px;
    }
 }
    </style>
</head>
<body>
      <h1>Catch The Falling Stars</h1>
    <div id="score">Score: 0</div>
    <div id="lives">Lives: 3</div>
    <div id="game-area" class="game-area">
        <div id="basket" class="basket"></div>
    </div>
    <div id="controls">
        <button onclick="startGame()" id="startBtn">Start</button>
        <button onclick="resetGame()" id="resetBtn">Reset</button>
    </div>
    <div id="message"></div>
    <script>
        const gameArea = document.getElementById("game-area");
let basket = document.getElementById("basket");
let scoreDisplay = document.getElementById("score");
let livesDisplay = document.getElementById("lives");
let message = document.getElementById("message");

let score = 0;
let lives = 3;
let gameActive = false;
let starInterval;
let basketPosition = 130;
const basketWidth = 100;

// We are trying to move the basket with the arrow keys

document.addEventListener("keydown",e=>{
    if(!gameActive) return;
    const step = 20;
    if(e.key === "ArrowLeft"){
        basketPosition = Math.max(0,basketPosition - step);
    }
     else if(e.key === "ArrowRight"){
        // gameArea.clientWidth is the width of the gamebox. Suppose it is 360px, the basketWidth is the width of the basket for example it is 100px.
        // basketPosition.step is the new position of the basket where we want to move the basket, and it can be any number.
        basketPosition = Math.min(gameArea.clientWidth - basketWidth, basketPosition + step);
        //               Math.min(360 - 100, 130 + 20) m(260,150)
    }
    basket.style.left = basketPosition + "px";
});

function createStar(){
    let star = document.createElement("div");
    star.classList.add("star");
    const x = Math.floor(Math.random()*(gameArea.clientWidth - 30));
    star.style.left = x + "px";
    // it means "move the star so that its left edge is x pixels away from the left border of the game area" so that means if x = 125, the star will appear 125 away from the left.
    star.style.top = "0px";
    gameArea.appendChild(star);
    let top = 0;
    const fallSpeed = Math.random()*3 + 2;
    // Math.random gives you a random number, a decimal number between 0 and 1, and the 0 is inclusive, but the 1 is exclusive, so it won't give you 1, but 0
    // i.e 0.17 * 3 = 0.51 + 2 = 2.51, so every new star will fall at a random speed between 2-5 pixel per interval

    const fall = setInterval(()=>{
        if(!gameActive){
            clearInterval(fall);
            star.remove();
            return;
        }
        top += fallSpeed;
        star.style.top = "";

        // check collision with basket, if it's colliding then it will work

        const starRect = star.getBoundingClientRect();
        const basketRect = basket.getBoundingClientRect();
        if(starRect.bottom > basketRect.top && starRect.left + starRect.width > basketRect.left && starRect.left < basketRect.right){
            score++;
            scoreDisplay.textContent = "score:" +score;
            star.remove();
            clearInterval(fall);
        }
        // if the star hits bottom

        if(top >= gameArea.clientWidth - 30){
            lives--;
            livesDisplay.textContent = "lives:" +lives;
            star.remove;
            clearInterval(fall);

              if(lives == 0){
                endGame();
              }
        }
      
    },300)
}

function startGame(){
    if(gameActive){
        return;
    }
    score = 0;
    lives = 3;
    gameActive = true;
    scoreDisplay.textContent = "score: 0";
    livesDisplay.textContent = "lives: 3";
    message.textContent = "Catch the Stars!";
    basketPosition = (gameArea.clientWidth - basketWidth)/2;
    basket.style.left = basketPosition + "px";
    starInterval = setInterval(createStar,800);
}

function endGame(){
    gameActive = false;
    clearInterval(starInterval);
    message.textContent = "Game Over! Final Score:" +score;
}

function resetGame(){
    endGame();
    score = 0;
    lives = 3;
    scoreDisplay.textContent = "score: 0";
    livesDisplay.textContent = "lives: 3";
    message.textContent = "";
    document.querySelectorAll(".star").forEach(star => star.remove());
    basketPosition = (gameArea.clientWidth - basketWidth)/2;
    basket.style.left = basketPosition + "px";
}
    </script>
</body>
</html>